{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Desktop/application/EFrontend/src/BuyCourses.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport Header from './Home/Header';\nimport Footer2 from './Home/Footer2';\nimport { useApi } from './hooks/useApi';\nimport { API_BASE, API_BASE_URL } from './config';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst COURSE = {\n  title: \"Net Zero Carbon Strategy for Business\",\n  description: \"A comprehensive course on decarbonisation, carbon accounting, carbon reduction, and sustainability for businesses. Taught by industry experts. Includes video lectures, downloadable resources, and a certificate.\",\n  price: 10,\n  image: require('./Home/Logo.png'),\n  id: 'netzero-carbon-course'\n};\nconst BuyCourses = () => {\n  _s();\n  const [date, setDate] = useState('');\n  const [people, setPeople] = useState(8);\n  const [checking, setChecking] = useState(false);\n  const [available, setAvailable] = useState(null);\n  const [error, setError] = useState('');\n  const [stripeLoading, setStripeLoading] = useState(false);\n  const [city, setCity] = useState('');\n  const [instructors, setInstructors] = useState([]);\n  const [selectedInstructor, setSelectedInstructor] = useState('');\n  const [availableSlots, setAvailableSlots] = useState([]);\n  const [selectedSlot, setSelectedSlot] = useState(null);\n  const [message, setMessage] = useState('');\n  const userPackage = (localStorage.getItem('package') || '').toLowerCase();\n  const isEligible = userPackage === 'pro' || userPackage === 'premium';\n  const hasCourse = localStorage.getItem('hasCourse') === 'true';\n  const [preferredStart, setPreferredStart] = useState('');\n  const [preferredEnd, setPreferredEnd] = useState('');\n  const [courses, setCourses] = useState([]);\n  const [selectedCourse, setSelectedCourse] = useState(null);\n  const {\n    get,\n    post\n  } = useApi();\n  const [area, setArea] = useState('');\n  const [bookingId, setBookingId] = useState(null);\n  const [bookingStatus, setBookingStatus] = useState('');\n  const pollingRef = useRef(null);\n  const [autofilled, setAutofilled] = useState(false);\n  const [confirmedBooking, setConfirmedBooking] = useState(null);\n  useEffect(() => {\n    // Optionally, fetch from backend if you want to check real purchase status\n  }, []);\n\n  // Fetch all courses on mount\n  useEffect(() => {\n    fetch(`${API_BASE_URL}/api/courses`).then(res => res.json()).then(data => setCourses(data));\n  }, []);\n\n  // Fetch instructors when city or area changes\n  useEffect(() => {\n    if (city) {\n      fetch(`${API_BASE_URL}/api/instructors?city=${encodeURIComponent(city)}`).then(res => res.json()).then(data => {\n        // First, filter by city and area\n        const areaMatches = data.filter(inst => {\n          var _inst$city, _inst$location;\n          return ((_inst$city = inst.city) === null || _inst$city === void 0 ? void 0 : _inst$city.toLowerCase()) === city.toLowerCase() && ((_inst$location = inst.location) === null || _inst$location === void 0 ? void 0 : _inst$location.toLowerCase()) === area.toLowerCase();\n        });\n        // If no area matches, show all city matches\n        const cityMatches = data.filter(inst => {\n          var _inst$city2;\n          return ((_inst$city2 = inst.city) === null || _inst$city2 === void 0 ? void 0 : _inst$city2.toLowerCase()) === city.toLowerCase();\n        });\n        const filtered = area && areaMatches.length > 0 ? areaMatches : cityMatches;\n        setInstructors(filtered);\n\n        // Aggregate unique courses from these instructors\n        const courseMap = {};\n        filtered.forEach(inst => {\n          (inst.subjects || []).forEach(subj => {\n            const key = subj.name + '|' + subj.durationWeeks;\n            if (!courseMap[key]) {\n              courseMap[key] = {\n                name: subj.name,\n                durationWeeks: subj.durationWeeks\n              };\n            }\n          });\n        });\n        setCourses(Object.values(courseMap));\n      }).catch(() => {\n        setInstructors([]);\n        setCourses([]);\n      });\n    } else {\n      setInstructors([]);\n      setCourses([]);\n    }\n    setSelectedInstructor('');\n    setAvailableSlots([]);\n    setSelectedSlot(null);\n    setSelectedCourse(null);\n  }, [city, area, date]);\n\n  // Helper to subtract a booking from a slot\n  function subtractBooking(slot, booking) {\n    // No overlap\n    if (booking.end <= slot.start || booking.start >= slot.end) return [slot];\n    // Booking covers the whole slot\n    if (booking.start <= slot.start && booking.end >= slot.end) return [];\n    // Booking overlaps at the start\n    if (booking.start <= slot.start && booking.end < slot.end) return [{\n      start: booking.end,\n      end: slot.end\n    }];\n    // Booking overlaps at the end\n    if (booking.start > slot.start && booking.end >= slot.end) return [{\n      start: slot.start,\n      end: booking.start\n    }];\n    // Booking is in the middle\n    return [{\n      start: slot.start,\n      end: booking.start\n    }, {\n      start: booking.end,\n      end: slot.end\n    }];\n  }\n\n  // Fetch available slots for all instructors in city for selected date and preferred time\n  useEffect(() => {\n    if (instructors.length && date && preferredStart && preferredEnd && selectedCourse) {\n      Promise.all(instructors.map(inst => fetch(`${API_BASE_URL}/api/instructors/profile/${inst.email}`).then(res => res.json()))).then(profiles => {\n        // Filter instructors who offer the selected course\n        const filteredProfiles = profiles.filter(inst => (inst.subjects || []).some(subj => subj.name === selectedCourse.name && String(subj.durationWeeks) === String(selectedCourse.durationWeeks)));\n        const day = new Date(date).toLocaleDateString('en-US', {\n          weekday: 'long'\n        });\n        let slots = [];\n        filteredProfiles.forEach(inst => {\n          var _inst$availability;\n          const avail = ((_inst$availability = inst.availability) === null || _inst$availability === void 0 ? void 0 : _inst$availability[day]) || [];\n          const bookings = (inst.bookings || []).filter(b => b.date === date);\n          avail.forEach(slot => {\n            let free = [{\n              ...slot\n            }];\n            bookings.forEach(bk => {\n              free = free.flatMap(s => subtractBooking(s, bk));\n            });\n            free.forEach(f => {\n              // Only show slots that overlap with preferred time\n              if (f.start && f.end && f.start <= preferredEnd && f.end >= preferredStart) {\n                // Clamp slot to preferred time\n                const slotStart = f.start < preferredStart ? preferredStart : f.start;\n                const slotEnd = f.end > preferredEnd ? preferredEnd : f.end;\n                slots.push({\n                  instructor: inst.email,\n                  start: slotStart,\n                  end: slotEnd,\n                  name: `${inst.firstName} ${inst.lastName}`,\n                  location: inst.location\n                });\n              }\n            });\n          });\n        });\n        setAvailableSlots(slots);\n      });\n    } else {\n      setAvailableSlots([]);\n    }\n  }, [instructors, date, preferredStart, preferredEnd, selectedCourse]);\n  const checkAvailability = async () => {\n    setChecking(true);\n    setError('');\n    setTimeout(() => {\n      setAvailable(true);\n      setChecking(false);\n    }, 700);\n  };\n  const handleBook = async () => {\n    if (!selectedCourse || !date || !city || !area) {\n      setError('Please fill all fields.');\n      return;\n    }\n    setStripeLoading(true);\n    setError('');\n    setMessage('');\n    try {\n      const userId = localStorage.getItem('userId');\n      if (!userId) {\n        setError('You must be logged in to book.');\n        setStripeLoading(false);\n        return;\n      }\n      const response = await fetch(`${API_BASE_URL}/api/bookings`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userId,\n          date,\n          city,\n          area,\n          courseName: selectedCourse.name,\n          durationWeeks: selectedCourse.durationWeeks\n        })\n      });\n      const data = await response.json();\n      if (response.status === 201) {\n        setMessage('Booking created and instructors notified. Awaiting instructor confirmation.');\n        setBookingId(data.bookingId);\n        setBookingStatus('on-hold');\n        // Start polling for status\n        if (pollingRef.current) clearInterval(pollingRef.current);\n        pollingRef.current = setInterval(async () => {\n          const statusRes = await fetch(`${API_BASE_URL}/api/bookings/${data.bookingId}/status`);\n          const statusData = await statusRes.json();\n          if (statusData.status === 'confirmed') {\n            setBookingStatus('confirmed');\n            setMessage('Booking confirmed! You can now proceed to payment.');\n            clearInterval(pollingRef.current);\n          }\n        }, 5000);\n      } else {\n        setError(data.message || 'Booking failed. Please try another date.');\n      }\n    } catch (err) {\n      setError('Booking error.');\n    }\n    setStripeLoading(false);\n  };\n  const handleCheckout = async () => {\n    setStripeLoading(true);\n    setError('');\n    let price = COURSE.price * people;\n    if (userPackage === 'premium') price = price * 0.8;\n    try {\n      const res = await fetch(`${API_BASE}/api/create-checkout-session`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          cart: [{\n            name: COURSE.title,\n            price,\n            quantity: 1\n          }]\n        })\n      });\n      const data = await res.json();\n      if (data.url) {\n        localStorage.setItem('purchasedPackage', `course:${COURSE.title}`);\n        localStorage.setItem('hasCourse', 'true');\n        if (bookingId) {\n          localStorage.setItem('bookingId', bookingId);\n        }\n        window.location.href = data.url;\n      } else {\n        setError('Failed to start checkout.');\n      }\n    } catch (err) {\n      setError('Checkout error.');\n    } finally {\n      setStripeLoading(false);\n    }\n  };\n\n  // Autofill form after booking is confirmed\n  useEffect(() => {\n    if (bookingId && bookingStatus === 'confirmed' && !autofilled) {\n      fetch(`${API_BASE_URL}/api/bookings/${bookingId}/status`).then(res => res.json()).then(data => {\n        if (data && data.status === 'confirmed') {\n          // Assume booking details are available in data or fetch full booking if needed\n          fetch(`${API_BASE_URL}/api/bookings/user/${localStorage.getItem('userId')}`).then(res => res.json()).then(bookings => {\n            const booking = bookings.find(b => b._id === bookingId);\n            if (booking) {\n              setDate(booking.date);\n              setCity(booking.city);\n              setArea(booking.area);\n              setSelectedCourse({\n                name: booking.courseName,\n                durationWeeks: booking.durationWeeks\n              });\n              setAutofilled(true);\n            }\n          });\n        }\n      });\n    }\n  }, [bookingId, bookingStatus, autofilled]);\n\n  // On page load, check for pending payment booking\n  useEffect(() => {\n    const userId = localStorage.getItem('userId');\n    if (!userId) return;\n    fetch(`${API_BASE_URL}/api/bookings/user/${userId}`).then(res => res.json()).then(bookings => {\n      // Find the latest booking that is confirmed but not paid\n      const pending = bookings.find(b => b.status === 'confirmed' && !b.paid);\n      if (pending) {\n        setBookingId(pending._id);\n        setDate(pending.date);\n        setCity(pending.city);\n        setArea(pending.area);\n        setSelectedCourse({\n          name: pending.courseName,\n          durationWeeks: pending.durationWeeks\n        });\n        setBookingStatus('confirmed');\n        setAutofilled(true);\n      } else {\n        // No pending payment, reset autofill\n        setBookingId(null);\n        setDate('');\n        setCity('');\n        setArea('');\n        setSelectedCourse(null);\n        setBookingStatus('');\n        setAutofilled(false);\n      }\n    });\n  }, []);\n\n  // After payment, clear autofill and allow new bookings\n  useEffect(() => {\n    if (autofilled && bookingStatus === 'confirmed' && hasCourse) {\n      setBookingId(null);\n      setDate('');\n      setCity('');\n      setArea('');\n      setSelectedCourse(null);\n      setBookingStatus('');\n      setAutofilled(false);\n    }\n  }, [hasCourse]);\n\n  // Show booking confirmation after payment\n  useEffect(() => {\n    const bookingIdLS = localStorage.getItem('bookingId');\n    if (hasCourse && bookingIdLS) {\n      fetch(`${API_BASE_URL}/api/bookings/${bookingIdLS}/status`).then(res => res.json()).then(data => {\n        setConfirmedBooking(data);\n        localStorage.removeItem('bookingId');\n      });\n    }\n  }, [hasCourse]);\n\n  // Always reset confirmation on mount so form is shown on new visits\n  useEffect(() => {\n    setConfirmedBooking(null);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: '200px',\n        background: '#fff',\n        minHeight: '100vh',\n        padding: '120px 0 60px 0',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 400,\n          background: '#fff',\n          borderRadius: 20,\n          boxShadow: '0 4px 24px rgba(0,0,0,0.08)',\n          overflow: 'hidden',\n          margin: '32px 0',\n          padding: 0\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            height: 180,\n            background: '#222',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            overflow: 'hidden',\n            position: 'relative'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: COURSE.image,\n            alt: \"Course\",\n            style: {\n              width: '100%',\n              height: '100%',\n              objectFit: 'cover'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              position: 'absolute',\n              top: 16,\n              left: 16,\n              background: '#ffb400',\n              color: '#fff',\n              borderRadius: 8,\n              padding: '4px 16px',\n              fontWeight: 600,\n              fontSize: 16,\n              boxShadow: '0 2px 8px rgba(0,0,0,0.08)',\n              display: 'inline-block'\n            },\n            children: \"Featured\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: 28\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            style: {\n              fontWeight: 700,\n              fontSize: 24,\n              marginBottom: 8\n            },\n            children: COURSE.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#222',\n              fontSize: 16,\n              marginBottom: 12\n            },\n            children: COURSE.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#27ae60',\n              fontWeight: 600,\n              fontSize: 18,\n              marginBottom: 8\n            },\n            children: [\"Price: $\", COURSE.price, \" per person \", userPackage === 'premium' && /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"(20% off for Premium!)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 79\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#888',\n              fontSize: 14,\n              marginBottom: 18\n            },\n            children: \"Minimum 8 people per booking.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 13\n          }, this), confirmedBooking ? /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: 'green',\n              fontWeight: 600,\n              fontSize: 18,\n              margin: '18px 0'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Booking Confirmed!\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Course: \", confirmedBooking.courseName]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Date: \", confirmedBooking.date]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"City: \", confirmedBooking.city]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Area: \", confirmedBooking.area]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 17\n            }, this), confirmedBooking.instructor && /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Instructor: \", confirmedBooking.instructor.firstName, \" \", confirmedBooking.instructor.lastName, \" (\", confirmedBooking.instructor.email, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Thank you for your payment! A confirmation email has been sent.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setConfirmedBooking(null);\n                setDate('');\n                setCity('');\n                setArea('');\n                setSelectedCourse(null);\n                setPeople(8);\n                setPreferredStart('');\n                setPreferredEnd('');\n                setAvailableSlots([]);\n                setSelectedSlot(null);\n                setMessage('');\n                setError('');\n                setBookingId(null);\n                setBookingStatus('');\n                setAutofilled(false);\n                // Add any other form field resets here if needed\n              },\n              style: {\n                marginTop: 16,\n                background: '#90be55',\n                color: '#fff',\n                border: 'none',\n                borderRadius: 6,\n                padding: '10px 24px',\n                fontWeight: 600,\n                fontSize: 16\n              },\n              children: \"Book Another Course\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [!isEligible && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#e74c3c',\n                fontWeight: 600,\n                fontSize: 18,\n                margin: '18px 0'\n              },\n              children: [\"You must have a Pro or Premium membership to buy this course.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 404,\n                columnNumber: 82\n              }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                href: \"/pricing\",\n                style: {\n                  color: '#ff6b57',\n                  textDecoration: 'underline'\n                },\n                children: \"See Membership Plans\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 405,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"ol\", {\n                style: {\n                  marginBottom: 16,\n                  color: '#888',\n                  fontSize: 15,\n                  paddingLeft: 18\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Select number of people (min 8)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 418,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Pick a date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 419,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Check availability\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 420,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"Proceed to checkout and payment\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 421,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 417,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: 8\n                },\n                children: \"Number of people (min 8):\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 423,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                min: 8,\n                value: people,\n                onChange: e => setPeople(Math.max(8, parseInt(e.target.value) || 8)),\n                style: {\n                  width: '100%',\n                  marginBottom: 12,\n                  padding: 8,\n                  borderRadius: 6,\n                  border: '1px solid #ccc'\n                },\n                disabled: bookingStatus === 'confirmed' && autofilled\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 424,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: 8\n                },\n                children: \"Location (City):\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 425,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: city,\n                onChange: e => setCity(e.target.value),\n                style: {\n                  width: '100%',\n                  marginBottom: 12,\n                  padding: 8,\n                  borderRadius: 6,\n                  border: '1px solid #ccc'\n                },\n                disabled: bookingStatus === 'confirmed' && autofilled\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 426,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: 8\n                },\n                children: \"Area/Location (e.g., Model Town):\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 427,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: area,\n                onChange: e => setArea(e.target.value),\n                style: {\n                  width: '100%',\n                  marginBottom: 12,\n                  padding: 8,\n                  borderRadius: 6,\n                  border: '1px solid #ccc'\n                },\n                disabled: bookingStatus === 'confirmed' && autofilled\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: 8\n                },\n                children: \"Pick a date:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 429,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                value: date,\n                onChange: e => setDate(e.target.value),\n                style: {\n                  width: '100%',\n                  marginBottom: 12,\n                  padding: 8,\n                  borderRadius: 6,\n                  border: '1px solid #ccc'\n                },\n                disabled: bookingStatus === 'confirmed' && autofilled\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 430,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: 8\n                },\n                children: \"Preferred Start Time:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 431,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"time\",\n                value: preferredStart,\n                onChange: e => setPreferredStart(e.target.value),\n                style: {\n                  width: '100%',\n                  marginBottom: 12,\n                  padding: 8,\n                  borderRadius: 6,\n                  border: '1px solid #ccc'\n                },\n                disabled: bookingStatus === 'confirmed' && autofilled\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 432,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: 8\n                },\n                children: \"Preferred End Time:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 433,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"time\",\n                value: preferredEnd,\n                onChange: e => setPreferredEnd(e.target.value),\n                style: {\n                  width: '100%',\n                  marginBottom: 12,\n                  padding: 8,\n                  borderRadius: 6,\n                  border: '1px solid #ccc'\n                },\n                disabled: bookingStatus === 'confirmed' && autofilled\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 434,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: 8\n                },\n                children: \"Select Course:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 435,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: selectedCourse ? selectedCourse.name + '|' + selectedCourse.durationWeeks : '',\n                onChange: e => {\n                  const [name, durationWeeks] = e.target.value.split('|');\n                  setSelectedCourse(courses.find(c => c.name === name && String(c.durationWeeks) === durationWeeks));\n                },\n                style: {\n                  width: '100%',\n                  marginBottom: 12,\n                  padding: 8,\n                  borderRadius: 6,\n                  border: '1px solid #ccc'\n                },\n                disabled: bookingStatus === 'confirmed' && autofilled,\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select a course\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 440,\n                  columnNumber: 21\n                }, this), courses.map((course, i) => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: course.name + '|' + course.durationWeeks,\n                  children: [course.name, \" (Duration: \", course.durationWeeks || '?', \" weeks)\"]\n                }, i, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 442,\n                  columnNumber: 23\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 19\n              }, this), bookingStatus === 'confirmed' && autofilled ? /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleCheckout,\n                disabled: stripeLoading,\n                style: {\n                  width: '100%',\n                  background: '#ff6b57',\n                  color: '#fff',\n                  border: 'none',\n                  borderRadius: 6,\n                  padding: '10px 0',\n                  fontWeight: 600\n                },\n                children: stripeLoading ? 'Processing Payment...' : `Pay Now ($${userPackage === 'premium' ? (COURSE.price * people * 0.8).toFixed(2) : (COURSE.price * people).toFixed(2)})`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 446,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleBook,\n                disabled: stripeLoading,\n                style: {\n                  width: '100%',\n                  background: '#90be55',\n                  color: '#fff',\n                  border: 'none',\n                  borderRadius: 6,\n                  padding: '10px 0',\n                  fontWeight: 600,\n                  marginBottom: 12\n                },\n                children: stripeLoading ? 'Booking...' : `Book Now ($${userPackage === 'premium' ? (COURSE.price * people * 0.8).toFixed(2) : (COURSE.price * people).toFixed(2)})`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 450,\n                columnNumber: 21\n              }, this), bookingStatus === 'on-hold' && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: '#888',\n                  marginTop: 12\n                },\n                children: \"Waiting for instructor confirmation...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 21\n              }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: 'green',\n                  marginTop: 8\n                },\n                children: message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 31\n              }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: 'red',\n                  marginTop: 8\n                },\n                children: error\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 458,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true)]\n          }, void 0, true)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer2, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 465,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(BuyCourses, \"G8zGJ3LZkzOgDOYM2hxlgSFTGl8=\", false, function () {\n  return [useApi];\n});\n_c = BuyCourses;\nexport default BuyCourses;\nvar _c;\n$RefreshReg$(_c, \"BuyCourses\");","map":{"version":3,"names":["React","useEffect","useState","useRef","Header","Footer2","useApi","API_BASE","API_BASE_URL","jsxDEV","_jsxDEV","Fragment","_Fragment","COURSE","title","description","price","image","require","id","BuyCourses","_s","date","setDate","people","setPeople","checking","setChecking","available","setAvailable","error","setError","stripeLoading","setStripeLoading","city","setCity","instructors","setInstructors","selectedInstructor","setSelectedInstructor","availableSlots","setAvailableSlots","selectedSlot","setSelectedSlot","message","setMessage","userPackage","localStorage","getItem","toLowerCase","isEligible","hasCourse","preferredStart","setPreferredStart","preferredEnd","setPreferredEnd","courses","setCourses","selectedCourse","setSelectedCourse","get","post","area","setArea","bookingId","setBookingId","bookingStatus","setBookingStatus","pollingRef","autofilled","setAutofilled","confirmedBooking","setConfirmedBooking","fetch","then","res","json","data","encodeURIComponent","areaMatches","filter","inst","_inst$city","_inst$location","location","cityMatches","_inst$city2","filtered","length","courseMap","forEach","subjects","subj","key","name","durationWeeks","Object","values","catch","subtractBooking","slot","booking","end","start","Promise","all","map","email","profiles","filteredProfiles","some","String","day","Date","toLocaleDateString","weekday","slots","_inst$availability","avail","availability","bookings","b","free","bk","flatMap","s","f","slotStart","slotEnd","push","instructor","firstName","lastName","checkAvailability","setTimeout","handleBook","userId","response","method","headers","body","JSON","stringify","courseName","status","current","clearInterval","setInterval","statusRes","statusData","err","handleCheckout","credentials","cart","quantity","url","setItem","window","href","find","_id","pending","paid","bookingIdLS","removeItem","children","fileName","_jsxFileName","lineNumber","columnNumber","style","margin","background","minHeight","padding","display","flexDirection","alignItems","width","borderRadius","boxShadow","overflow","height","justifyContent","position","src","alt","objectFit","top","left","color","fontWeight","fontSize","marginBottom","onClick","marginTop","border","textDecoration","paddingLeft","type","min","value","onChange","e","Math","max","parseInt","target","disabled","split","c","course","i","toFixed","_c","$RefreshReg$"],"sources":["/Users/mac/Desktop/application/EFrontend/src/BuyCourses.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport Header from './Home/Header';\nimport Footer2 from './Home/Footer2';\nimport { useApi } from './hooks/useApi';\nimport { API_BASE, API_BASE_URL } from './config';\n\nconst COURSE = {\n  title: \"Net Zero Carbon Strategy for Business\",\n  description: \"A comprehensive course on decarbonisation, carbon accounting, carbon reduction, and sustainability for businesses. Taught by industry experts. Includes video lectures, downloadable resources, and a certificate.\",\n  price: 10,\n  image: require('./Home/Logo.png'),\n  id: 'netzero-carbon-course',\n};\n\nconst BuyCourses = () => {\n  const [date, setDate] = useState('');\n  const [people, setPeople] = useState(8);\n  const [checking, setChecking] = useState(false);\n  const [available, setAvailable] = useState(null);\n  const [error, setError] = useState('');\n  const [stripeLoading, setStripeLoading] = useState(false);\n  const [city, setCity] = useState('');\n  const [instructors, setInstructors] = useState([]);\n  const [selectedInstructor, setSelectedInstructor] = useState('');\n  const [availableSlots, setAvailableSlots] = useState([]);\n  const [selectedSlot, setSelectedSlot] = useState(null);\n  const [message, setMessage] = useState('');\n  const userPackage = (localStorage.getItem('package') || '').toLowerCase();\n  const isEligible = userPackage === 'pro' || userPackage === 'premium';\n  const hasCourse = localStorage.getItem('hasCourse') === 'true';\n  const [preferredStart, setPreferredStart] = useState('');\n  const [preferredEnd, setPreferredEnd] = useState('');\n  const [courses, setCourses] = useState([]);\n  const [selectedCourse, setSelectedCourse] = useState(null);\n  const { get, post } = useApi();\n  const [area, setArea] = useState('');\n  const [bookingId, setBookingId] = useState(null);\n  const [bookingStatus, setBookingStatus] = useState('');\n  const pollingRef = useRef(null);\n  const [autofilled, setAutofilled] = useState(false);\n  const [confirmedBooking, setConfirmedBooking] = useState(null);\n\n  useEffect(() => {\n    // Optionally, fetch from backend if you want to check real purchase status\n  }, []);\n\n  // Fetch all courses on mount\n  useEffect(() => {\n    fetch(`${API_BASE_URL}/api/courses`)\n      .then(res => res.json())\n      .then(data => setCourses(data));\n  }, []);\n\n  // Fetch instructors when city or area changes\n  useEffect(() => {\n    if (city) {\n      fetch(`${API_BASE_URL}/api/instructors?city=${encodeURIComponent(city)}`)\n        .then(res => res.json())\n        .then(data => {\n          // First, filter by city and area\n          const areaMatches = data.filter(inst =>\n            inst.city?.toLowerCase() === city.toLowerCase() &&\n            inst.location?.toLowerCase() === area.toLowerCase()\n          );\n          // If no area matches, show all city matches\n          const cityMatches = data.filter(inst =>\n            inst.city?.toLowerCase() === city.toLowerCase()\n          );\n          const filtered = area && areaMatches.length > 0 ? areaMatches : cityMatches;\n          setInstructors(filtered);\n\n          // Aggregate unique courses from these instructors\n          const courseMap = {};\n          filtered.forEach(inst => {\n            (inst.subjects || []).forEach(subj => {\n              const key = subj.name + '|' + subj.durationWeeks;\n              if (!courseMap[key]) {\n                courseMap[key] = { name: subj.name, durationWeeks: subj.durationWeeks };\n              }\n            });\n          });\n          setCourses(Object.values(courseMap));\n        })\n        .catch(() => {\n          setInstructors([]);\n          setCourses([]);\n        });\n    } else {\n      setInstructors([]);\n      setCourses([]);\n    }\n    setSelectedInstructor('');\n    setAvailableSlots([]);\n    setSelectedSlot(null);\n    setSelectedCourse(null);\n  }, [city, area, date]);\n\n  // Helper to subtract a booking from a slot\n  function subtractBooking(slot, booking) {\n    // No overlap\n    if (booking.end <= slot.start || booking.start >= slot.end) return [slot];\n    // Booking covers the whole slot\n    if (booking.start <= slot.start && booking.end >= slot.end) return [];\n    // Booking overlaps at the start\n    if (booking.start <= slot.start && booking.end < slot.end) return [{ start: booking.end, end: slot.end }];\n    // Booking overlaps at the end\n    if (booking.start > slot.start && booking.end >= slot.end) return [{ start: slot.start, end: booking.start }];\n    // Booking is in the middle\n    return [\n      { start: slot.start, end: booking.start },\n      { start: booking.end, end: slot.end }\n    ];\n  }\n\n  // Fetch available slots for all instructors in city for selected date and preferred time\n  useEffect(() => {\n    if (instructors.length && date && preferredStart && preferredEnd && selectedCourse) {\n      Promise.all(instructors.map(inst =>\n        fetch(`${API_BASE_URL}/api/instructors/profile/${inst.email}`)\n          .then(res => res.json())\n      )).then(profiles => {\n        // Filter instructors who offer the selected course\n        const filteredProfiles = profiles.filter(inst =>\n          (inst.subjects || []).some(subj =>\n            subj.name === selectedCourse.name && String(subj.durationWeeks) === String(selectedCourse.durationWeeks)\n          )\n        );\n        const day = new Date(date).toLocaleDateString('en-US', { weekday: 'long' });\n        let slots = [];\n        filteredProfiles.forEach(inst => {\n          const avail = inst.availability?.[day] || [];\n          const bookings = (inst.bookings || []).filter(b => b.date === date);\n          avail.forEach(slot => {\n            let free = [{ ...slot }];\n            bookings.forEach(bk => {\n              free = free.flatMap(s => subtractBooking(s, bk));\n            });\n            free.forEach(f => {\n              // Only show slots that overlap with preferred time\n              if (\n                f.start && f.end &&\n                f.start <= preferredEnd && f.end >= preferredStart\n              ) {\n                // Clamp slot to preferred time\n                const slotStart = f.start < preferredStart ? preferredStart : f.start;\n                const slotEnd = f.end > preferredEnd ? preferredEnd : f.end;\n                slots.push({ instructor: inst.email, start: slotStart, end: slotEnd, name: `${inst.firstName} ${inst.lastName}`, location: inst.location });\n              }\n            });\n          });\n        });\n        setAvailableSlots(slots);\n      });\n    } else {\n      setAvailableSlots([]);\n    }\n  }, [instructors, date, preferredStart, preferredEnd, selectedCourse]);\n\n  const checkAvailability = async () => {\n    setChecking(true);\n    setError('');\n    setTimeout(() => {\n      setAvailable(true);\n      setChecking(false);\n    }, 700);\n  };\n\n  const handleBook = async () => {\n    if (!selectedCourse || !date || !city || !area) {\n      setError('Please fill all fields.');\n      return;\n    }\n    setStripeLoading(true);\n    setError('');\n    setMessage('');\n    try {\n      const userId = localStorage.getItem('userId');\n      if (!userId) {\n        setError('You must be logged in to book.');\n        setStripeLoading(false);\n        return;\n      }\n      const response = await fetch(`${API_BASE_URL}/api/bookings`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          userId,\n          date,\n          city,\n          area,\n          courseName: selectedCourse.name,\n          durationWeeks: selectedCourse.durationWeeks\n        })\n      });\n      const data = await response.json();\n      if (response.status === 201) {\n        setMessage('Booking created and instructors notified. Awaiting instructor confirmation.');\n        setBookingId(data.bookingId);\n        setBookingStatus('on-hold');\n        // Start polling for status\n        if (pollingRef.current) clearInterval(pollingRef.current);\n        pollingRef.current = setInterval(async () => {\n          const statusRes = await fetch(`${API_BASE_URL}/api/bookings/${data.bookingId}/status`);\n          const statusData = await statusRes.json();\n          if (statusData.status === 'confirmed') {\n            setBookingStatus('confirmed');\n            setMessage('Booking confirmed! You can now proceed to payment.');\n            clearInterval(pollingRef.current);\n          }\n        }, 5000);\n      } else {\n        setError(data.message || 'Booking failed. Please try another date.');\n      }\n    } catch (err) {\n      setError('Booking error.');\n    }\n    setStripeLoading(false);\n  };\n\n  const handleCheckout = async () => {\n    setStripeLoading(true);\n    setError('');\n    let price = COURSE.price * people;\n    if (userPackage === 'premium') price = price * 0.8;\n    try {\n      const res = await fetch(`${API_BASE}/api/create-checkout-session`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({\n          cart: [{ name: COURSE.title, price, quantity: 1 }]\n        })\n      });\n      const data = await res.json();\n      if (data.url) {\n        localStorage.setItem('purchasedPackage', `course:${COURSE.title}`);\n        localStorage.setItem('hasCourse', 'true');\n        if (bookingId) {\n          localStorage.setItem('bookingId', bookingId);\n        }\n        window.location.href = data.url;\n      } else {\n        setError('Failed to start checkout.');\n      }\n    } catch (err) {\n      setError('Checkout error.');\n    } finally {\n      setStripeLoading(false);\n    }\n  };\n\n  // Autofill form after booking is confirmed\n  useEffect(() => {\n    if (bookingId && bookingStatus === 'confirmed' && !autofilled) {\n      fetch(`${API_BASE_URL}/api/bookings/${bookingId}/status`)\n        .then(res => res.json())\n        .then(data => {\n          if (data && data.status === 'confirmed') {\n            // Assume booking details are available in data or fetch full booking if needed\n            fetch(`${API_BASE_URL}/api/bookings/user/${localStorage.getItem('userId')}`)\n              .then(res => res.json())\n              .then(bookings => {\n                const booking = bookings.find(b => b._id === bookingId);\n                if (booking) {\n                  setDate(booking.date);\n                  setCity(booking.city);\n                  setArea(booking.area);\n                  setSelectedCourse({ name: booking.courseName, durationWeeks: booking.durationWeeks });\n                  setAutofilled(true);\n                }\n              });\n          }\n        });\n    }\n  }, [bookingId, bookingStatus, autofilled]);\n\n  // On page load, check for pending payment booking\n  useEffect(() => {\n    const userId = localStorage.getItem('userId');\n    if (!userId) return;\n    fetch(`${API_BASE_URL}/api/bookings/user/${userId}`)\n      .then(res => res.json())\n      .then(bookings => {\n        // Find the latest booking that is confirmed but not paid\n        const pending = bookings.find(\n          b => b.status === 'confirmed' && !b.paid\n        );\n        if (pending) {\n          setBookingId(pending._id);\n          setDate(pending.date);\n          setCity(pending.city);\n          setArea(pending.area);\n          setSelectedCourse({ name: pending.courseName, durationWeeks: pending.durationWeeks });\n          setBookingStatus('confirmed');\n          setAutofilled(true);\n        } else {\n          // No pending payment, reset autofill\n          setBookingId(null);\n          setDate('');\n          setCity('');\n          setArea('');\n          setSelectedCourse(null);\n          setBookingStatus('');\n          setAutofilled(false);\n        }\n      });\n  }, []);\n\n  // After payment, clear autofill and allow new bookings\n  useEffect(() => {\n    if (autofilled && bookingStatus === 'confirmed' && hasCourse) {\n      setBookingId(null);\n      setDate('');\n      setCity('');\n      setArea('');\n      setSelectedCourse(null);\n      setBookingStatus('');\n      setAutofilled(false);\n    }\n  }, [hasCourse]);\n\n  // Show booking confirmation after payment\n  useEffect(() => {\n    const bookingIdLS = localStorage.getItem('bookingId');\n    if (hasCourse && bookingIdLS) {\n      fetch(`${API_BASE_URL}/api/bookings/${bookingIdLS}/status`)\n        .then(res => res.json())\n        .then(data => {\n          setConfirmedBooking(data);\n          localStorage.removeItem('bookingId');\n        });\n    }\n  }, [hasCourse]);\n\n  // Always reset confirmation on mount so form is shown on new visits\n  useEffect(() => {\n    setConfirmedBooking(null);\n  }, []);\n\n  return (\n    <>\n      <Header />\n      <div style={{ margin:'200px',background: '#fff', minHeight: '100vh', padding: '120px 0 60px 0', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n        <div style={{ width: 400, background: '#fff', borderRadius: 20, boxShadow: '0 4px 24px rgba(0,0,0,0.08)', overflow: 'hidden', margin: '32px 0', padding: 0 }}>\n          <div style={{ height: 180, background: '#222', display: 'flex', alignItems: 'center', justifyContent: 'center', overflow: 'hidden', position: 'relative' }}>\n            <img src={COURSE.image} alt=\"Course\" style={{ width: '100%', height: '100%', objectFit: 'cover' }} />\n            <span style={{\n              position: 'absolute',\n              top: 16,\n              left: 16,\n              background: '#ffb400',\n              color: '#fff',\n              borderRadius: 8,\n              padding: '4px 16px',\n              fontWeight: 600,\n              fontSize: 16,\n              boxShadow: '0 2px 8px rgba(0,0,0,0.08)',\n              display: 'inline-block',\n            }}>Featured</span>\n          </div>\n          <div style={{ padding: 28 }}>\n            <h2 style={{ fontWeight: 700, fontSize: 24, marginBottom: 8 }}>{COURSE.title}</h2>\n            <div style={{ color: '#222', fontSize: 16, marginBottom: 12 }}>{COURSE.description}</div>\n            <div style={{ color: '#27ae60', fontWeight: 600, fontSize: 18, marginBottom: 8 }}>\n              Price: ${COURSE.price} per person {userPackage === 'premium' && <span>(20% off for Premium!)</span>}\n            </div>\n            <div style={{ color: '#888', fontSize: 14, marginBottom: 18 }}>Minimum 8 people per booking.</div>\n            {confirmedBooking ? (\n              <div style={{ color: 'green', fontWeight: 600, fontSize: 18, margin: '18px 0' }}>\n                <h2>Booking Confirmed!</h2>\n                <p>Course: {confirmedBooking.courseName}</p>\n                <p>Date: {confirmedBooking.date}</p>\n                <p>City: {confirmedBooking.city}</p>\n                <p>Area: {confirmedBooking.area}</p>\n                {confirmedBooking.instructor && (\n                  <p>Instructor: {confirmedBooking.instructor.firstName} {confirmedBooking.instructor.lastName} ({confirmedBooking.instructor.email})</p>\n                )}\n                <p>Thank you for your payment! A confirmation email has been sent.</p>\n                <button onClick={() => {\n                  setConfirmedBooking(null);\n                  setDate('');\n                  setCity('');\n                  setArea('');\n                  setSelectedCourse(null);\n                  setPeople(8);\n                  setPreferredStart('');\n                  setPreferredEnd('');\n                  setAvailableSlots([]);\n                  setSelectedSlot(null);\n                  setMessage('');\n                  setError('');\n                  setBookingId(null);\n                  setBookingStatus('');\n                  setAutofilled(false);\n                  // Add any other form field resets here if needed\n                }} style={{marginTop: 16, background: '#90be55', color: '#fff', border: 'none', borderRadius: 6, padding: '10px 24px', fontWeight: 600, fontSize: 16}}>\n                  Book Another Course\n                </button>\n              </div>\n            ) : (\n              <>\n                {!isEligible && (\n                  <div style={{ color: '#e74c3c', fontWeight: 600, fontSize: 18, margin: '18px 0' }}>\n                    You must have a Pro or Premium membership to buy this course.<br />\n                    <a href=\"/pricing\" style={{ color: '#ff6b57', textDecoration: 'underline' }}>See Membership Plans</a>\n                  </div>\n                )}\n                {/* Remove this block so the form is always shown */}\n                {/* {hasCourse && (\n                  <div style={{ color: '#27ae60', fontWeight: 600, fontSize: 18, margin: '18px 0' }}>\n                    You have already purchased this course.<br />\n                    <a href=\"/courses\" style={{ color: '#ff6b57', textDecoration: 'underline' }}>Go to Courses</a>\n                  </div>\n                )} */}\n                {/* Always show the booking form. Disable fields and show Pay Now if confirmed and not paid. */}\n                <>\n                  <ol style={{ marginBottom: 16, color: '#888', fontSize: 15, paddingLeft: 18 }}>\n                    <li>Select number of people (min 8)</li>\n                    <li>Pick a date</li>\n                    <li>Check availability</li>\n                    <li>Proceed to checkout and payment</li>\n                  </ol>\n                  <label style={{ display: 'block', marginBottom: 8 }}>Number of people (min 8):</label>\n                  <input type=\"number\" min={8} value={people} onChange={e => setPeople(Math.max(8, parseInt(e.target.value)||8))} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>Location (City):</label>\n                  <input type=\"text\" value={city} onChange={e => setCity(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>Area/Location (e.g., Model Town):</label>\n                  <input type=\"text\" value={area} onChange={e => setArea(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>Pick a date:</label>\n                  <input type=\"date\" value={date} onChange={e => setDate(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>Preferred Start Time:</label>\n                  <input type=\"time\" value={preferredStart} onChange={e => setPreferredStart(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>Preferred End Time:</label>\n                  <input type=\"time\" value={preferredEnd} onChange={e => setPreferredEnd(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>Select Course:</label>\n                  <select value={selectedCourse ? selectedCourse.name + '|' + selectedCourse.durationWeeks : ''} onChange={e => {\n                    const [name, durationWeeks] = e.target.value.split('|');\n                    setSelectedCourse(courses.find(c => c.name === name && String(c.durationWeeks) === durationWeeks));\n                  }} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled}>\n                    <option value=\"\">Select a course</option>\n                    {courses.map((course, i) => (\n                      <option key={i} value={course.name + '|' + course.durationWeeks}>{course.name} (Duration: {course.durationWeeks || '?'} weeks)</option>\n                    ))}\n                  </select>\n                  {bookingStatus === 'confirmed' && autofilled ? (\n                    <button onClick={handleCheckout} disabled={stripeLoading} style={{ width: '100%', background: '#ff6b57', color: '#fff', border: 'none', borderRadius: 6, padding: '10px 0', fontWeight: 600 }}>\n                      {stripeLoading ? 'Processing Payment...' : `Pay Now ($${userPackage === 'premium' ? (COURSE.price*people*0.8).toFixed(2) : (COURSE.price*people).toFixed(2)})`}\n                    </button>\n                  ) : (\n                    <button onClick={handleBook} disabled={stripeLoading} style={{ width: '100%', background: '#90be55', color: '#fff', border: 'none', borderRadius: 6, padding: '10px 0', fontWeight: 600, marginBottom: 12 }}>\n                      {stripeLoading ? 'Booking...' : `Book Now ($${userPackage === 'premium' ? (COURSE.price*people*0.8).toFixed(2) : (COURSE.price*people).toFixed(2)})`}\n                    </button>\n                  )}\n                  {bookingStatus === 'on-hold' && (\n                    <div style={{ color: '#888', marginTop: 12 }}>Waiting for instructor confirmation...</div>\n                  )}\n                  {message && <div style={{ color: 'green', marginTop: 8 }}>{message}</div>}\n                  {error && <div style={{ color: 'red', marginTop: 8 }}>{error}</div>}\n                </>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n      <Footer2 />\n    </>\n  );\n};\n\nexport default BuyCourses; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}